labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = 0.2
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = 1,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 10,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .7,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 10,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 10,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, color="blue4", fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, color="white", fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, color="white", fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility',
x="lat",
y="long")
ggplot()+
geom_sf(data=counties, color="white", fill="black", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility',
x="lat",
y="long")
ggplot()+
geom_sf(data=counties, color="white", fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility',
x="lat",
y="long")
ggplot()+
geom_sf(data=counties, color="white", fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Economic Mobility for Econ 158 Hometowns',
x="lat",
y="long")
missing_data <- Econ_158_join[is.na(Econ_158_join$City) |
is.na(Econ_158_join$`HH income age 35`), ]
# View the missing data
print(missing_data)
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = 1.5,      # Increased more
point.padding = 1,      # Increased point padding
force = 20,             # Increased repulsion force
force_pull = 0,         # Keep minimal pull force
direction = "both",     # Allow movement in any direction
max.iter = 10000,       # Increase iterations to find better positions
seed = 123              # Set seed for reproducible label placement
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
# Add jittered points
geom_jitter_sf(data=Econ_158_centroid,
aes(color=`HH income age 35`),
width = 0.1,  # adjust these values based on your map scale
height = 0.1) +
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = 1,
point.padding = 0.5,
force = 10,
seed = 123
)+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
# Then use in the plot
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_sf(data=Econ_158_centroid_jittered, aes(color=`HH income age 35`))+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = 1,
point.padding = 0.5,
force = 10,
seed = 123
)+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
# Convert centroids to regular coordinates and jitter them
Econ_158_centroid_jittered <- Econ_158_centroid %>%
mutate(
geometry = st_jitter(geometry, amount = 0.1)  # adjust amount as needed
)
# Then use in the plot
ggplot()+
geom_sf(data=counties, fill="blue4", alpha=.3)+
geom_sf(data=Econ_158_centroid_jittered, aes(color=`HH income age 35`))+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = 1,
point.padding = 0.5,
force = 10,
seed = 123
)+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Econ 158 hometowns and Economic Mobility')
View(Econ_158_Hometowns)
View(Econ_158_Hometowns)
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point()+
geom_smooth(method=ln, se=FALSE)+
theme_bw()
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point()+
geom_smooth(method=lm, se=FALSE)+
theme_bw()
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point()+
geom_smooth(method=lm, se=FALSE)+
theme_bw()+
labs(title = 'Economic Mobility and Median Rent')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
geom_smooth(method=lm, se=FALSE)+
theme_bw()+
labs(title = 'Economic Mobility and Median Rent')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_label_repel(
data = Econ_158_Hometowns,
aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
geom_smooth(method=lm, se=FALSE)+
theme_bw()+
labs(title = 'Economic Mobility and Median Rent')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_smooth(method=lm, se=FALSE)+
geom_label_repel(aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
theme_bw()+
labs(title = 'Economic Mobility and Median Rent')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`poverty rate`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_smooth(method=lm, se=FALSE)+
geom_label_repel(aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
theme_bw()+
labs(title = 'Economic Mobility and Poverty Rates')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`fraction single parents`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_smooth(method=lm, se=FALSE)+
geom_label_repel(aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
theme_bw()+
labs(title = 'Economic Mobility and Fraction Single Parents')
library(tigris)
library(sf)
library(tidyverse)
library(ggrepel)
tracts<-tracts(state="CA")
counties<-counties(state="CA")
Econ_158_Hometowns <- read_csv("Downloads/Econ 158 Hometowns - Sheet1.csv")
Econ_158<-Econ_158_Hometowns%>%
mutate(Tract=as.character(Tract))%>%
mutate(county_tract=str_sub(Tract,-9,-1))%>%
mutate(TRACTCE=str_sub(Tract,-6,-1))%>%
mutate(COUNTYFP=str_sub(county_tract,1,3))
Econ_158_join<-right_join(tracts, Econ_158)
Econ_158_centroid<-st_centroid(Econ_158_join)
ggplot()+
geom_sf(data=counties, color="white", fill="blue4", alpha=.3)+
geom_label_repel(
data = Econ_158_join,
aes(label = City,
geometry = geometry,
fill = `HH income age 35`),
stat = "sf_coordinates",
min.segment.length = .3,
max.overlaps = Inf,
box.padding = .3,     # Increased from 0.2 to 1
point.padding = 0.5, # Added point padding
force = 5,         # Added force to push labels further
force_pull = 0,     # Reduced pull force to allow labels to move further
direction = "both"  # Allows labels to move in any direction
)+
geom_sf(data=Econ_158_centroid, aes(color=`HH income age 35`))+
theme_bw()+
scale_fill_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
labs(title = 'Economic Mobility for Econ 158 Hometowns',
x="lat",
y="long")
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`median rent`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_smooth(method=lm, se=FALSE)+
geom_label_repel(aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
theme_bw()+
labs(title = 'Economic Mobility and Median Rent')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`poverty rate`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_smooth(method=lm, se=FALSE)+
geom_label_repel(aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
theme_bw()+
labs(title = 'Economic Mobility and Poverty Rates')
ggplot(data=Econ_158_Hometowns,
mapping=aes(x=`fraction single parents`, y=`HH income age 35`))+
geom_point(aes(color=`HH income age 35`))+
geom_smooth(method=lm, se=FALSE)+
geom_label_repel(aes(label = City))+
scale_colour_gradient2(low="red", mid="yellow", high="green", midpoint=40)+
theme_bw()+
labs(title = 'Economic Mobility and Fraction Single Parents')
setwd("/Users/verosovero/Downloads/econ106-test-site")
quarto_render()
library(quarto)
quarto_render()
quarto_render()
setwd("/Users/verosovero/Downloads/econ106-full-site")
quarto_render()
quarto_render()
setwd("~/Dropbox/Teaching/Data analytics/econ106-full-site")
quarto_render()
quarto_render()
quarto_render()
setwd("~/Dropbox/Teaching/Data analytics/econ106-test-site")
quarto_render()
setwd("~/Dropbox/Teaching/Data analytics/econ106-updated-site")
quarto_render()
setwd("~/Dropbox/Teaching/Data analytics/econ106-updated-site-final")
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
setwd("~/Dropbox/Teaching/github/Econ106F24")
quarto_render()
quarto_render()
quarto_render()
quarto_render()
setwd("~/Dropbox/Teaching/github/Econ106F24")
quarto_render()
setwd("~/Dropbox/Teaching/github/Econ106F24")
quarto_render()
quarto_render()
quarto_render()
quarto_render()
